import{b as E,d as M,e as S,g as _,h as j,i as F}from"./assets/createMarkup-Ba0XG9hl.js";import{f as Y,d as k,b as v}from"./assets/vendor-Cw4SvEfu.js";function L(){return window.innerWidth<=767?{limit:5,offset:0,requiredCharacters:5,currentCategory:"mobile"}:window.innerWidth<=1439?{limit:8,offset:0,requiredCharacters:8,currentCategory:"tablet"}:{limit:16,offset:0,requiredCharacters:16,currentCategory:"desktop"}}const B=document.querySelector("#date-picker"),x=document.querySelector(".js-filter-form"),i=document.querySelector(".js-characters-list"),q=document.querySelector(".js-main-character__btn"),g=document.querySelector(".js-loader"),p=document.querySelector("body"),w=document.querySelector(".notFound__box"),{limit:D,offset:W,requiredCharacters:H,currentCategory:I}=L(),r={limit:D,offset:W,requiredCharacters:H,currentCategory:I,total:0},a={comics:null,name:null,orderBy:null,date:null};function N(){const e=L();e.currentCategory!==r.currentCategory&&(r.currentCategory=e.currentCategory,r.limit=e.limit,r.offset=0,r.requiredCharacters=e.requiredCharacters,d(),i.innerHTML="")}function y(e,t){e?(g.style.display="block",p.style.pointerEvents="none"):(g.style.display="none",p.style.pointerEvents="all"),q.style.display=t?"block":"none"}function T(e){e?(w.style.display="",i.style.display="none"):(w.style.display="none",i.style.display="")}d();function V(e){const t=e.target;switch(t.name){case"comics":a.comics=t.value.replace(/[^0-9]/g,"");break;case"name":a.name=t.value;break;case"orderBy":a.orderBy=t.value.toLowerCase();break}r.offset=0,i.innerHTML="",d()}async function d(){let e=[];for(y(!0,!1);e.length<r.requiredCharacters;){try{const{data:t}=await E(a,r.offset,r.limit);r.total=t.total,T(!t.results.length);const o=t.results.filter(({thumbnail:{path:n}})=>!n.endsWith("image_not_available")&&!n.endsWith("4c002e0305708"));e=[...e,...o],r.offset+=r.limit}catch(t){console.log("Помилка під час запиту:",t);break}if(r.total<=r.offset){y(!1,!1);break}if(e.length>=r.requiredCharacters){e=e.slice(0,r.requiredCharacters),y(!1,!0);break}}i.insertAdjacentHTML("beforeend",M(e))}function $(){d()}Y(B,{defaultDate:new Date,allowInput:!0,onClose:(e,t,o)=>{if(z(t))a.date=t;else{Notiflix.Notify.failure("Invalid date format. Expected YYYY-MM-DD"),o.clear(),a.date=null;return}}});function z(e){return/^\d{4}-\d{2}-\d{2}$/.test(e)}q.addEventListener("click",$);x.addEventListener("input",k(800,V));window.addEventListener("resize",k(1e3,N));function R(){const e=document.querySelector(".js-characters-modal__list"),t=document.querySelector("body");let o;const n={onShow(c){return o=m.bind(c),document.addEventListener("keydown",o),t.style.overflowY="hidden",!0},onClose(){return t.style.overflowY="",document.removeEventListener("keydown",o),!0}};function s(c){const C=c.target;if(C.classList.contains("js-characters-list"))return;const u=C.closest(".characters-modal__item"),b=u==null?void 0:u.dataset.comicsid;b&&S(b).then(f=>{v.create(_(f),n).show()}).catch(f=>console.log(f))}function m(c){c.code==="Escape"&&this.close()}e.addEventListener("click",s)}const A=document.querySelector(".js-characters-list"),l=document.querySelector("body");let h;const P={onShow(e){return h=G.bind(e),document.addEventListener("keydown",h),l.style.overflowY="hidden",!0},onClose(){return l.style.overflowY="",document.removeEventListener("keydown",h),!0}};function U(e){const t=e.target;if(t.classList.contains("js-characters-list"))return;const o=t.closest(".characters__item"),n=o==null?void 0:o.dataset.url;n?(l.style.pointerEvents="none",j(n).then(s=>{v.create(F(s),P).show()}).catch(s=>console.log(s)).finally(()=>{l.style.pointerEvents="all",R()})):console.error("URL not found")}function G(e){e.code==="Escape"&&this.close()}A.addEventListener("click",U);
//# sourceMappingURL=characters.js.map
