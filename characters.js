import{b as M,d as S,e as _,g as j,h as F,i as Y}from"./assets/createMarkup-Ba0XG9hl.js";import{f as B,d as v,b as k}from"./assets/vendor-Cw4SvEfu.js";function L(){return window.innerWidth<=767?{limit:5,offset:0,requiredCharacters:5,currentCategory:"mobile"}:window.innerWidth<=1439?{limit:8,offset:0,requiredCharacters:8,currentCategory:"tablet"}:{limit:16,offset:0,requiredCharacters:16,currentCategory:"desktop"}}const x=document.querySelector("#date-picker"),D=document.querySelector(".js-filter-form"),i=document.querySelector(".js-characters-list"),q=document.querySelector(".js-main-character__btn"),g=document.querySelector(".js-loader"),w=document.querySelector("body"),b=document.querySelector(".notFound__box"),I=document.querySelector(".js-page-header__input"),W=new URLSearchParams(window.location.search),E=W.get("search");I.value=E??"";const{limit:H,offset:N,requiredCharacters:P,currentCategory:R}=L(),r={limit:H,offset:N,requiredCharacters:P,currentCategory:R,total:0},a={comics:null,name:E,orderBy:null,date:null};function T(){const e=L();e.currentCategory!==r.currentCategory&&(r.currentCategory=e.currentCategory,r.limit=e.limit,r.offset=0,r.requiredCharacters=e.requiredCharacters,d(),i.innerHTML="")}function h(e,t){e?(g.style.display="block",w.style.pointerEvents="none"):(g.style.display="none",w.style.pointerEvents="all"),q.style.display=t?"block":"none"}function V(e){e?(b.style.display="",i.style.display="none"):(b.style.display="none",i.style.display="")}d();function $(e){const t=e.target;switch(t.name){case"comics":a.comics=t.value.replace(/[^0-9]/g,"");break;case"name":a.name=t.value;break;case"orderBy":a.orderBy=t.value.toLowerCase();break}r.offset=0,i.innerHTML="",d()}async function d(){let e=[];for(h(!0,!1);e.length<r.requiredCharacters;){try{const{data:t}=await M(a,r.offset,r.limit);r.total=t.total,V(!t.results.length);const o=t.results.filter(({thumbnail:{path:n}})=>!n.endsWith("image_not_available")&&!n.endsWith("4c002e0305708"));e=[...e,...o],r.offset+=r.limit}catch(t){console.log("Помилка під час запиту:",t);break}if(r.total<=r.offset){h(!1,!1);break}if(e.length>=r.requiredCharacters){e=e.slice(0,r.requiredCharacters),h(!1,!0);break}}i.insertAdjacentHTML("beforeend",S(e))}function z(){d()}B(x,{defaultDate:new Date,allowInput:!0,onClose:(e,t,o)=>{if(U(t))a.date=t;else{Notiflix.Notify.failure("Invalid date format. Expected YYYY-MM-DD"),o.clear(),a.date=null;return}}});function U(e){return/^\d{4}-\d{2}-\d{2}$/.test(e)}q.addEventListener("click",z);D.addEventListener("input",v(800,$));window.addEventListener("resize",v(1e3,T));function A(){const e=document.querySelector(".js-characters-modal__list"),t=document.querySelector("body");let o;const n={onShow(c){return o=m.bind(c),document.addEventListener("keydown",o),t.style.overflowY="hidden",!0},onClose(){return t.style.overflowY="",document.removeEventListener("keydown",o),!0}};function s(c){const C=c.target;if(C.classList.contains("js-characters-list"))return;const u=C.closest(".characters-modal__item"),p=u==null?void 0:u.dataset.comicsid;p&&_(p).then(f=>{k.create(j(f),n).show()}).catch(f=>console.log(f))}function m(c){c.code==="Escape"&&this.close()}e.addEventListener("click",s)}const Q=document.querySelector(".js-characters-list"),l=document.querySelector("body");let y;const G={onShow(e){return y=K.bind(e),document.addEventListener("keydown",y),l.style.overflowY="hidden",!0},onClose(){return l.style.overflowY="",document.removeEventListener("keydown",y),!0}};function J(e){const t=e.target;if(t.classList.contains("js-characters-list"))return;const o=t.closest(".characters__item"),n=o==null?void 0:o.dataset.url;n?(l.style.pointerEvents="none",F(n).then(s=>{k.create(Y(s),G).show()}).catch(s=>console.log(s)).finally(()=>{l.style.pointerEvents="all",A()})):console.error("URL not found")}function K(e){e.code==="Escape"&&this.close()}Q.addEventListener("click",J);
//# sourceMappingURL=characters.js.map
