{"version":3,"file":"characters.js","sources":["../src/js/mainCharactersGetCategory.ts","../src/js/mainCharactersMarkup.ts"],"sourcesContent":["function getCategory() {\n    if (window.innerWidth <= 767) {\n        return { limit: 5, offset: 0, requiredCharacters: 5, currentCategory: 'mobile' };\n    } else if (window.innerWidth <= 1439) {\n        return { limit: 8, offset: 0, requiredCharacters: 8, currentCategory: 'tablet' };\n    } else {\n        return { limit: 16, offset: 0, requiredCharacters: 16, currentCategory: 'desktop' };\n    }\n}\n\nexport {getCategory}","import { fetchAllCharacters } from \"./api\";\nimport { debounce } from 'throttle-debounce';\nimport { ICharacters, IinitialState } from './interface'\nimport { getCategory } from \"./mainCharactersGetCategory\";\n\nconst charactersList = document.querySelector('.js-characters-list') as HTMLElement;\nconst loadMoreBtn = document.querySelector('.main-characters__btn') as HTMLElement;\n\nconst { limit, offset, requiredCharacters, currentCategory } = getCategory();\n\nconst initialState: IinitialState = {\n    limit,\n    offset,\n    requiredCharacters,\n    currentCategory,\n}\n\n    window.addEventListener('resize', debounce(1000, handleResize));\n    loadMoreBtn.addEventListener('click', loadMoreCharacters);\n    \n    filterValidateCharacters();\n    \nfunction handleResize() {\n    const newCategory = getCategory();\n\n    if (newCategory.currentCategory !== initialState.currentCategory) {\n        initialState.currentCategory = newCategory.currentCategory;\n        initialState.limit = newCategory.limit;\n        initialState.offset = 0; \n        initialState.requiredCharacters = newCategory.requiredCharacters;\n\n        charactersList.innerHTML = '';\n\n        filterValidateCharacters();\n    }\n}\n\nasync function filterValidateCharacters() {\n    let validCharacters: ICharacters[] = [];\n\n    while (validCharacters.length < initialState.requiredCharacters) {\n        try {\n            const { data } = await fetchAllCharacters(initialState.offset, initialState.limit);\n\n            const filteredCharacters = data.results.filter(({ thumbnail: { path } }: ICharacters) => {\n                return !path.endsWith('image_not_available') && !path.endsWith('4c002e0305708');\n            });\n\n            validCharacters = [...validCharacters, ...filteredCharacters];\n\n            initialState.offset += initialState.limit;\n\n        } catch (err) {\n            console.log(\"Помилка під час запиту:\", err);\n            break;\n        }\n\n        if (validCharacters.length >= initialState.requiredCharacters) {\n            validCharacters = validCharacters.slice(0, initialState.requiredCharacters);\n            break;\n        }\n    }\n\n    charactersList.insertAdjacentHTML('beforeend', createMarkup(validCharacters));\n}\n\nfunction loadMoreCharacters() {\n    filterValidateCharacters();\n}\n\nfunction createMarkup(arr: ICharacters[]): string {\n    return arr.map(({ name, resourceURI, thumbnail: { extension, path } }) => {\n        return `\n            <li class=\"characters__item\" data-url='${resourceURI}'>\n                <img src=\"${path}.${extension}\" alt=\"${name}\" class=\"characters__img\" />\n                <p class=\"characters__name\">${name}</p>\n            </li>\n        `;\n    }).join('');\n}\n\n"],"names":["getCategory","charactersList","loadMoreBtn","limit","offset","requiredCharacters","currentCategory","initialState","debounce","handleResize","loadMoreCharacters","filterValidateCharacters","newCategory","validCharacters","data","fetchAllCharacters","filteredCharacters","path","err","createMarkup","arr","name","resourceURI","extension"],"mappings":"6FAAA,SAASA,GAAc,CACf,OAAA,OAAO,YAAc,IACd,CAAE,MAAO,EAAG,OAAQ,EAAG,mBAAoB,EAAG,gBAAiB,UAC/D,OAAO,YAAc,KACrB,CAAE,MAAO,EAAG,OAAQ,EAAG,mBAAoB,EAAG,gBAAiB,UAE/D,CAAE,MAAO,GAAI,OAAQ,EAAG,mBAAoB,GAAI,gBAAiB,UAEhF,CCHA,MAAMC,EAAiB,SAAS,cAAc,qBAAqB,EAC7DC,EAAc,SAAS,cAAc,uBAAuB,EAE5D,CAAE,MAAAC,EAAO,OAAAC,EAAQ,mBAAAC,EAAoB,gBAAAC,GAAoBN,EAAY,EAErEO,EAA8B,CAChC,MAAAJ,EACA,OAAAC,EACA,mBAAAC,EACA,gBAAAC,CACJ,EAEI,OAAO,iBAAiB,SAAUE,EAAS,IAAMC,CAAY,CAAC,EAC9DP,EAAY,iBAAiB,QAASQ,CAAkB,EAExDC,IAEJ,SAASF,GAAe,CACpB,MAAMG,EAAcZ,IAEhBY,EAAY,kBAAoBL,EAAa,kBAC7CA,EAAa,gBAAkBK,EAAY,gBAC3CL,EAAa,MAAQK,EAAY,MACjCL,EAAa,OAAS,EACtBA,EAAa,mBAAqBK,EAAY,mBAE9CX,EAAe,UAAY,GAEFU,IAEjC,CAEA,eAAeA,GAA2B,CACtC,IAAIE,EAAiC,CAAA,EAE9B,KAAAA,EAAgB,OAASN,EAAa,oBAAoB,CACzD,GAAA,CACM,KAAA,CAAE,KAAAO,CAAS,EAAA,MAAMC,EAAmBR,EAAa,OAAQA,EAAa,KAAK,EAE3ES,EAAqBF,EAAK,QAAQ,OAAO,CAAC,CAAE,UAAW,CAAE,KAAAG,CAAK,KACzD,CAACA,EAAK,SAAS,qBAAqB,GAAK,CAACA,EAAK,SAAS,eAAe,CACjF,EAEDJ,EAAkB,CAAC,GAAGA,EAAiB,GAAGG,CAAkB,EAE5DT,EAAa,QAAUA,EAAa,YAE/BW,EAAK,CACF,QAAA,IAAI,0BAA2BA,CAAG,EAC1C,KACJ,CAEI,GAAAL,EAAgB,QAAUN,EAAa,mBAAoB,CAC3DM,EAAkBA,EAAgB,MAAM,EAAGN,EAAa,kBAAkB,EAC1E,KACJ,CACJ,CAEAN,EAAe,mBAAmB,YAAakB,EAAaN,CAAe,CAAC,CAChF,CAEA,SAASH,GAAqB,CACDC,GAC7B,CAEA,SAASQ,EAAaC,EAA4B,CACvC,OAAAA,EAAI,IAAI,CAAC,CAAE,KAAAC,EAAM,YAAAC,EAAa,UAAW,CAAE,UAAAC,EAAW,KAAAN,CAAK,KACvD;AAAA,qDACsCK,CAAW;AAAA,4BACpCL,CAAI,IAAIM,CAAS,UAAUF,CAAI;AAAA,8CACbA,CAAI;AAAA;AAAA,SAG7C,EAAE,KAAK,EAAE,CACd"}